2023-04-17 14:41:45,889 - INFO - Log directory: ./libcity/log
2023-04-17 14:41:45,890 - INFO - Begin pipeline, task=traffic_state_pred, model_name=GRU, dataset_name=Xiongan_grid, exp_id=50001
2023-04-17 14:41:45,890 - INFO - {'task': 'traffic_state_pred', 'model': 'RNN', 'dataset': 'Xiongan_grid', 'saved_model': True, 'train': True, 'exp_id': '50001', 'seed': 0, 'dataset_class': 'TrafficStatePointDataset', 'executor': 'TrafficStateExecutor', 'evaluator': 'TrafficStateEvaluator', 'rnn_type': 'GRU', 'hidden_size': 64, 'num_layers': 1, 'dropout': 0, 'bidirectional': False, 'teacher_forcing_ratio': 0, 'scaler': 'standard', 'load_external': True, 'normal_external': False, 'ext_scaler': 'none', 'add_time_in_day': True, 'add_day_in_week': False, 'max_epoch': 50, 'learner': 'adam', 'learning_rate': 0.01, 'lr_decay': True, 'lr_scheduler': 'multisteplr', 'lr_decay_ratio': 0.1, 'steps': [5, 20, 40, 70], 'clip_grad_norm': True, 'max_grad_norm': 5, 'use_early_stop': True, 'patience': 50, 'batch_size': 64, 'cache_dataset': True, 'num_workers': 0, 'pad_with_last_sample': True, 'train_rate': 0.7, 'eval_rate': 0.1, 'input_window': 12, 'output_window': 12, 'gpu': True, 'gpu_id': 0, 'train_loss': 'none', 'epoch': 0, 'weight_decay': 0, 'lr_epsilon': 1e-08, 'lr_beta1': 0.9, 'lr_beta2': 0.999, 'lr_alpha': 0.99, 'lr_momentum': 0, 'step_size': 10, 'lr_T_max': 30, 'lr_eta_min': 0, 'lr_patience': 10, 'lr_threshold': 0.0001, 'log_level': 'INFO', 'log_every': 1, 'load_best_epoch': True, 'hyper_tune': False, 'metrics': ['MAE', 'MAPE', 'MSE', 'RMSE', 'masked_MAE', 'masked_MAPE', 'masked_MSE', 'masked_RMSE', 'R2', 'EVAR'], 'evaluator_mode': 'single', 'save_mode': ['csv'], 'geo': {'including_types': ['Point'], 'Point': {}}, 'rel': {'including_types': ['geo'], 'geo': {'cost': 'num'}}, 'dyna': {'including_types': ['state'], 'state': {'entity_id': 'geo_id', 'traffic_speed': 'num'}}, 'data_col': ['traffic_speed'], 'weight_col': 'cost', 'data_files': ['Xiongan_grid'], 'geo_file': 'Xiongan_grid', 'rel_file': 'Xiongan_grid', 'output_dim': 1, 'time_intervals': 300, 'init_weight_inf_or_zero': 'inf', 'set_weight_link_or_dist': 'dist', 'calculate_weight_adj': True, 'weight_adj_epsilon': 0.1, 'device': device(type='cuda', index=0)}
2023-04-17 14:41:45,898 - INFO - Loaded file Xiongan_grid.geo, num_nodes=364
2023-04-17 14:41:45,900 - INFO - set_weight_link_or_dist: dist
2023-04-17 14:41:45,900 - INFO - init_weight_inf_or_zero: inf
2023-04-17 14:41:45,904 - INFO - Loaded file Xiongan_grid.rel, shape=(364, 364)
2023-04-17 14:41:45,904 - INFO - Start Calculate the weight by Gauss kernel!
2023-04-17 14:41:45,906 - INFO - Loading file Xiongan_grid.dyna
2023-04-17 14:41:45,934 - INFO - Loaded file Xiongan_grid.dyna, shape=(60, 364, 1)
2023-04-17 14:41:45,944 - INFO - Dataset created
2023-04-17 14:41:45,944 - INFO - x shape: (37, 12, 364, 2), y shape: (37, 12, 364, 2)
2023-04-17 14:41:45,945 - INFO - train	x: (26, 12, 364, 2), y: (26, 12, 364, 2)
2023-04-17 14:41:45,945 - INFO - eval	x: (4, 12, 364, 2), y: (4, 12, 364, 2)
2023-04-17 14:41:45,945 - INFO - test	x: (7, 12, 364, 2), y: (7, 12, 364, 2)
2023-04-17 14:41:46,139 - INFO - Saved at ./libcity/cache/dataset_cache/point_based_Xiongan_grid_12_12_0.7_0.1_standard_64_True_True_False_True.npz
2023-04-17 14:41:46,140 - INFO - StandardScaler mean: 59.99072364799272, std: 5.747457510909558
2023-04-17 14:41:46,140 - INFO - NoneScaler
2023-04-17 14:41:46,284 - INFO - You select rnn_type GRU in RNN!
2023-04-17 14:41:49,124 - INFO - RNN(
  (rnn): GRU(728, 64)
  (fc): Linear(in_features=64, out_features=364, bias=True)
)
2023-04-17 14:41:49,125 - INFO - rnn.weight_ih_l0	torch.Size([192, 728])	cuda:0	True
2023-04-17 14:41:49,125 - INFO - rnn.weight_hh_l0	torch.Size([192, 64])	cuda:0	True
2023-04-17 14:41:49,125 - INFO - rnn.bias_ih_l0	torch.Size([192])	cuda:0	True
2023-04-17 14:41:49,125 - INFO - rnn.bias_hh_l0	torch.Size([192])	cuda:0	True
2023-04-17 14:41:49,125 - INFO - fc.weight	torch.Size([364, 64])	cuda:0	True
2023-04-17 14:41:49,125 - INFO - fc.bias	torch.Size([364])	cuda:0	True
2023-04-17 14:41:49,125 - INFO - Total parameter numbers: 176108
2023-04-17 14:41:49,125 - INFO - You select `adam` optimizer.
2023-04-17 14:41:49,125 - INFO - You select `multisteplr` lr_scheduler.
2023-04-17 14:41:49,126 - WARNING - Received none train loss func and will use the loss func defined in the model.
2023-04-17 14:41:49,126 - INFO - Start training ...
2023-04-17 14:41:49,126 - INFO - num_batches:1
2023-04-17 14:41:49,178 - INFO - epoch complete!
2023-04-17 14:41:49,178 - INFO - evaluating now!
2023-04-17 14:41:49,196 - INFO - Epoch [0/50] train_loss: 5.0029, val_loss: 5.0400, lr: 0.010000, 0.07s
2023-04-17 14:41:49,202 - INFO - Saved model at 0
2023-04-17 14:41:49,202 - INFO - Val loss decrease from inf to 5.0400, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch0.tar
2023-04-17 14:41:49,238 - INFO - epoch complete!
2023-04-17 14:41:49,239 - INFO - evaluating now!
2023-04-17 14:41:49,256 - INFO - Epoch [1/50] train_loss: 5.0400, val_loss: 5.0026, lr: 0.010000, 0.05s
2023-04-17 14:41:49,262 - INFO - Saved model at 1
2023-04-17 14:41:49,262 - INFO - Val loss decrease from 5.0400 to 5.0026, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch1.tar
2023-04-17 14:41:49,298 - INFO - epoch complete!
2023-04-17 14:41:49,298 - INFO - evaluating now!
2023-04-17 14:41:49,314 - INFO - Epoch [2/50] train_loss: 5.0026, val_loss: 4.8209, lr: 0.010000, 0.05s
2023-04-17 14:41:49,320 - INFO - Saved model at 2
2023-04-17 14:41:49,320 - INFO - Val loss decrease from 5.0026 to 4.8209, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch2.tar
2023-04-17 14:41:49,355 - INFO - epoch complete!
2023-04-17 14:41:49,355 - INFO - evaluating now!
2023-04-17 14:41:49,372 - INFO - Epoch [3/50] train_loss: 4.8209, val_loss: 4.6200, lr: 0.010000, 0.05s
2023-04-17 14:41:49,377 - INFO - Saved model at 3
2023-04-17 14:41:49,377 - INFO - Val loss decrease from 4.8209 to 4.6200, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch3.tar
2023-04-17 14:41:49,410 - INFO - epoch complete!
2023-04-17 14:41:49,410 - INFO - evaluating now!
2023-04-17 14:41:49,428 - INFO - Epoch [4/50] train_loss: 4.6200, val_loss: 4.4735, lr: 0.001000, 0.05s
2023-04-17 14:41:49,433 - INFO - Saved model at 4
2023-04-17 14:41:49,433 - INFO - Val loss decrease from 4.6200 to 4.4735, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch4.tar
2023-04-17 14:41:49,467 - INFO - epoch complete!
2023-04-17 14:41:49,467 - INFO - evaluating now!
2023-04-17 14:41:49,484 - INFO - Epoch [5/50] train_loss: 4.4735, val_loss: 4.4485, lr: 0.001000, 0.05s
2023-04-17 14:41:49,489 - INFO - Saved model at 5
2023-04-17 14:41:49,490 - INFO - Val loss decrease from 4.4735 to 4.4485, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch5.tar
2023-04-17 14:41:49,525 - INFO - epoch complete!
2023-04-17 14:41:49,525 - INFO - evaluating now!
2023-04-17 14:41:49,541 - INFO - Epoch [6/50] train_loss: 4.4485, val_loss: 4.4201, lr: 0.001000, 0.05s
2023-04-17 14:41:49,546 - INFO - Saved model at 6
2023-04-17 14:41:49,546 - INFO - Val loss decrease from 4.4485 to 4.4201, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch6.tar
2023-04-17 14:41:49,578 - INFO - epoch complete!
2023-04-17 14:41:49,579 - INFO - evaluating now!
2023-04-17 14:41:49,594 - INFO - Epoch [7/50] train_loss: 4.4201, val_loss: 4.3919, lr: 0.001000, 0.05s
2023-04-17 14:41:49,600 - INFO - Saved model at 7
2023-04-17 14:41:49,600 - INFO - Val loss decrease from 4.4201 to 4.3919, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch7.tar
2023-04-17 14:41:49,631 - INFO - epoch complete!
2023-04-17 14:41:49,632 - INFO - evaluating now!
2023-04-17 14:41:49,648 - INFO - Epoch [8/50] train_loss: 4.3919, val_loss: 4.3634, lr: 0.001000, 0.05s
2023-04-17 14:41:49,654 - INFO - Saved model at 8
2023-04-17 14:41:49,654 - INFO - Val loss decrease from 4.3919 to 4.3634, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch8.tar
2023-04-17 14:41:49,689 - INFO - epoch complete!
2023-04-17 14:41:49,690 - INFO - evaluating now!
2023-04-17 14:41:49,708 - INFO - Epoch [9/50] train_loss: 4.3634, val_loss: 4.3353, lr: 0.001000, 0.05s
2023-04-17 14:41:49,714 - INFO - Saved model at 9
2023-04-17 14:41:49,714 - INFO - Val loss decrease from 4.3634 to 4.3353, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch9.tar
2023-04-17 14:41:49,742 - INFO - epoch complete!
2023-04-17 14:41:49,743 - INFO - evaluating now!
2023-04-17 14:41:49,758 - INFO - Epoch [10/50] train_loss: 4.3353, val_loss: 4.3083, lr: 0.001000, 0.04s
2023-04-17 14:41:49,764 - INFO - Saved model at 10
2023-04-17 14:41:49,770 - INFO - Val loss decrease from 4.3353 to 4.3083, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch10.tar
2023-04-17 14:41:49,805 - INFO - epoch complete!
2023-04-17 14:41:49,805 - INFO - evaluating now!
2023-04-17 14:41:49,820 - INFO - Epoch [11/50] train_loss: 4.3083, val_loss: 4.2829, lr: 0.001000, 0.05s
2023-04-17 14:41:49,826 - INFO - Saved model at 11
2023-04-17 14:41:49,826 - INFO - Val loss decrease from 4.3083 to 4.2829, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch11.tar
2023-04-17 14:41:49,861 - INFO - epoch complete!
2023-04-17 14:41:49,861 - INFO - evaluating now!
2023-04-17 14:41:49,878 - INFO - Epoch [12/50] train_loss: 4.2829, val_loss: 4.2561, lr: 0.001000, 0.05s
2023-04-17 14:41:49,884 - INFO - Saved model at 12
2023-04-17 14:41:49,884 - INFO - Val loss decrease from 4.2829 to 4.2561, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch12.tar
2023-04-17 14:41:49,916 - INFO - epoch complete!
2023-04-17 14:41:49,917 - INFO - evaluating now!
2023-04-17 14:41:49,935 - INFO - Epoch [13/50] train_loss: 4.2561, val_loss: 4.2283, lr: 0.001000, 0.05s
2023-04-17 14:41:49,940 - INFO - Saved model at 13
2023-04-17 14:41:49,940 - INFO - Val loss decrease from 4.2561 to 4.2283, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch13.tar
2023-04-17 14:41:49,975 - INFO - epoch complete!
2023-04-17 14:41:49,975 - INFO - evaluating now!
2023-04-17 14:41:49,993 - INFO - Epoch [14/50] train_loss: 4.2283, val_loss: 4.2012, lr: 0.001000, 0.05s
2023-04-17 14:41:50,000 - INFO - Saved model at 14
2023-04-17 14:41:50,000 - INFO - Val loss decrease from 4.2283 to 4.2012, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch14.tar
2023-04-17 14:41:50,033 - INFO - epoch complete!
2023-04-17 14:41:50,034 - INFO - evaluating now!
2023-04-17 14:41:50,050 - INFO - Epoch [15/50] train_loss: 4.2012, val_loss: 4.1738, lr: 0.001000, 0.05s
2023-04-17 14:41:50,055 - INFO - Saved model at 15
2023-04-17 14:41:50,055 - INFO - Val loss decrease from 4.2012 to 4.1738, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch15.tar
2023-04-17 14:41:50,083 - INFO - epoch complete!
2023-04-17 14:41:50,084 - INFO - evaluating now!
2023-04-17 14:41:50,100 - INFO - Epoch [16/50] train_loss: 4.1738, val_loss: 4.1467, lr: 0.001000, 0.04s
2023-04-17 14:41:50,106 - INFO - Saved model at 16
2023-04-17 14:41:50,106 - INFO - Val loss decrease from 4.1738 to 4.1467, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch16.tar
2023-04-17 14:41:50,154 - INFO - epoch complete!
2023-04-17 14:41:50,154 - INFO - evaluating now!
2023-04-17 14:41:50,173 - INFO - Epoch [17/50] train_loss: 4.1467, val_loss: 4.1191, lr: 0.001000, 0.07s
2023-04-17 14:41:50,179 - INFO - Saved model at 17
2023-04-17 14:41:50,179 - INFO - Val loss decrease from 4.1467 to 4.1191, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch17.tar
2023-04-17 14:41:50,206 - INFO - epoch complete!
2023-04-17 14:41:50,207 - INFO - evaluating now!
2023-04-17 14:41:50,223 - INFO - Epoch [18/50] train_loss: 4.1191, val_loss: 4.0919, lr: 0.001000, 0.04s
2023-04-17 14:41:50,229 - INFO - Saved model at 18
2023-04-17 14:41:50,229 - INFO - Val loss decrease from 4.1191 to 4.0919, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch18.tar
2023-04-17 14:41:50,261 - INFO - epoch complete!
2023-04-17 14:41:50,261 - INFO - evaluating now!
2023-04-17 14:41:50,278 - INFO - Epoch [19/50] train_loss: 4.0919, val_loss: 4.0656, lr: 0.000100, 0.05s
2023-04-17 14:41:50,284 - INFO - Saved model at 19
2023-04-17 14:41:50,284 - INFO - Val loss decrease from 4.0919 to 4.0656, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch19.tar
2023-04-17 14:41:50,318 - INFO - epoch complete!
2023-04-17 14:41:50,318 - INFO - evaluating now!
2023-04-17 14:41:50,336 - INFO - Epoch [20/50] train_loss: 4.0656, val_loss: 4.0627, lr: 0.000100, 0.05s
2023-04-17 14:41:50,342 - INFO - Saved model at 20
2023-04-17 14:41:50,342 - INFO - Val loss decrease from 4.0656 to 4.0627, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch20.tar
2023-04-17 14:41:50,379 - INFO - epoch complete!
2023-04-17 14:41:50,380 - INFO - evaluating now!
2023-04-17 14:41:50,397 - INFO - Epoch [21/50] train_loss: 4.0627, val_loss: 4.0595, lr: 0.000100, 0.05s
2023-04-17 14:41:50,403 - INFO - Saved model at 21
2023-04-17 14:41:50,403 - INFO - Val loss decrease from 4.0627 to 4.0595, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch21.tar
2023-04-17 14:41:50,432 - INFO - epoch complete!
2023-04-17 14:41:50,432 - INFO - evaluating now!
2023-04-17 14:41:50,450 - INFO - Epoch [22/50] train_loss: 4.0595, val_loss: 4.0562, lr: 0.000100, 0.05s
2023-04-17 14:41:50,456 - INFO - Saved model at 22
2023-04-17 14:41:50,456 - INFO - Val loss decrease from 4.0595 to 4.0562, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch22.tar
2023-04-17 14:41:50,495 - INFO - epoch complete!
2023-04-17 14:41:50,495 - INFO - evaluating now!
2023-04-17 14:41:50,515 - INFO - Epoch [23/50] train_loss: 4.0562, val_loss: 4.0527, lr: 0.000100, 0.06s
2023-04-17 14:41:50,521 - INFO - Saved model at 23
2023-04-17 14:41:50,521 - INFO - Val loss decrease from 4.0562 to 4.0527, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch23.tar
2023-04-17 14:41:50,555 - INFO - epoch complete!
2023-04-17 14:41:50,556 - INFO - evaluating now!
2023-04-17 14:41:50,574 - INFO - Epoch [24/50] train_loss: 4.0527, val_loss: 4.0492, lr: 0.000100, 0.05s
2023-04-17 14:41:50,580 - INFO - Saved model at 24
2023-04-17 14:41:50,580 - INFO - Val loss decrease from 4.0527 to 4.0492, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch24.tar
2023-04-17 14:41:50,621 - INFO - epoch complete!
2023-04-17 14:41:50,622 - INFO - evaluating now!
2023-04-17 14:41:50,642 - INFO - Epoch [25/50] train_loss: 4.0492, val_loss: 4.0458, lr: 0.000100, 0.06s
2023-04-17 14:41:50,648 - INFO - Saved model at 25
2023-04-17 14:41:50,648 - INFO - Val loss decrease from 4.0492 to 4.0458, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch25.tar
2023-04-17 14:41:50,686 - INFO - epoch complete!
2023-04-17 14:41:50,686 - INFO - evaluating now!
2023-04-17 14:41:50,706 - INFO - Epoch [26/50] train_loss: 4.0458, val_loss: 4.0422, lr: 0.000100, 0.06s
2023-04-17 14:41:50,712 - INFO - Saved model at 26
2023-04-17 14:41:50,712 - INFO - Val loss decrease from 4.0458 to 4.0422, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch26.tar
2023-04-17 14:41:50,750 - INFO - epoch complete!
2023-04-17 14:41:50,751 - INFO - evaluating now!
2023-04-17 14:41:50,768 - INFO - Epoch [27/50] train_loss: 4.0422, val_loss: 4.0386, lr: 0.000100, 0.06s
2023-04-17 14:41:50,774 - INFO - Saved model at 27
2023-04-17 14:41:50,774 - INFO - Val loss decrease from 4.0422 to 4.0386, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch27.tar
2023-04-17 14:41:50,810 - INFO - epoch complete!
2023-04-17 14:41:50,810 - INFO - evaluating now!
2023-04-17 14:41:50,831 - INFO - Epoch [28/50] train_loss: 4.0386, val_loss: 4.0350, lr: 0.000100, 0.06s
2023-04-17 14:41:50,837 - INFO - Saved model at 28
2023-04-17 14:41:50,837 - INFO - Val loss decrease from 4.0386 to 4.0350, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch28.tar
2023-04-17 14:41:50,875 - INFO - epoch complete!
2023-04-17 14:41:50,875 - INFO - evaluating now!
2023-04-17 14:41:50,895 - INFO - Epoch [29/50] train_loss: 4.0350, val_loss: 4.0314, lr: 0.000100, 0.06s
2023-04-17 14:41:50,901 - INFO - Saved model at 29
2023-04-17 14:41:50,901 - INFO - Val loss decrease from 4.0350 to 4.0314, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch29.tar
2023-04-17 14:41:50,936 - INFO - epoch complete!
2023-04-17 14:41:50,936 - INFO - evaluating now!
2023-04-17 14:41:50,960 - INFO - Epoch [30/50] train_loss: 4.0314, val_loss: 4.0278, lr: 0.000100, 0.06s
2023-04-17 14:41:50,965 - INFO - Saved model at 30
2023-04-17 14:41:50,966 - INFO - Val loss decrease from 4.0314 to 4.0278, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch30.tar
2023-04-17 14:41:50,997 - INFO - epoch complete!
2023-04-17 14:41:50,997 - INFO - evaluating now!
2023-04-17 14:41:51,014 - INFO - Epoch [31/50] train_loss: 4.0278, val_loss: 4.0242, lr: 0.000100, 0.05s
2023-04-17 14:41:51,019 - INFO - Saved model at 31
2023-04-17 14:41:51,019 - INFO - Val loss decrease from 4.0278 to 4.0242, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch31.tar
2023-04-17 14:41:51,057 - INFO - epoch complete!
2023-04-17 14:41:51,057 - INFO - evaluating now!
2023-04-17 14:41:51,074 - INFO - Epoch [32/50] train_loss: 4.0242, val_loss: 4.0205, lr: 0.000100, 0.05s
2023-04-17 14:41:51,080 - INFO - Saved model at 32
2023-04-17 14:41:51,080 - INFO - Val loss decrease from 4.0242 to 4.0205, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch32.tar
2023-04-17 14:41:51,118 - INFO - epoch complete!
2023-04-17 14:41:51,118 - INFO - evaluating now!
2023-04-17 14:41:51,135 - INFO - Epoch [33/50] train_loss: 4.0205, val_loss: 4.0169, lr: 0.000100, 0.05s
2023-04-17 14:41:51,141 - INFO - Saved model at 33
2023-04-17 14:41:51,141 - INFO - Val loss decrease from 4.0205 to 4.0169, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch33.tar
2023-04-17 14:41:51,179 - INFO - epoch complete!
2023-04-17 14:41:51,179 - INFO - evaluating now!
2023-04-17 14:41:51,199 - INFO - Epoch [34/50] train_loss: 4.0169, val_loss: 4.0132, lr: 0.000100, 0.06s
2023-04-17 14:41:51,205 - INFO - Saved model at 34
2023-04-17 14:41:51,205 - INFO - Val loss decrease from 4.0169 to 4.0132, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch34.tar
2023-04-17 14:41:51,242 - INFO - epoch complete!
2023-04-17 14:41:51,243 - INFO - evaluating now!
2023-04-17 14:41:51,261 - INFO - Epoch [35/50] train_loss: 4.0132, val_loss: 4.0094, lr: 0.000100, 0.06s
2023-04-17 14:41:51,267 - INFO - Saved model at 35
2023-04-17 14:41:51,267 - INFO - Val loss decrease from 4.0132 to 4.0094, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch35.tar
2023-04-17 14:41:51,306 - INFO - epoch complete!
2023-04-17 14:41:51,307 - INFO - evaluating now!
2023-04-17 14:41:51,327 - INFO - Epoch [36/50] train_loss: 4.0094, val_loss: 4.0057, lr: 0.000100, 0.06s
2023-04-17 14:41:51,333 - INFO - Saved model at 36
2023-04-17 14:41:51,333 - INFO - Val loss decrease from 4.0094 to 4.0057, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch36.tar
2023-04-17 14:41:51,367 - INFO - epoch complete!
2023-04-17 14:41:51,368 - INFO - evaluating now!
2023-04-17 14:41:51,385 - INFO - Epoch [37/50] train_loss: 4.0057, val_loss: 4.0020, lr: 0.000100, 0.05s
2023-04-17 14:41:51,391 - INFO - Saved model at 37
2023-04-17 14:41:51,391 - INFO - Val loss decrease from 4.0057 to 4.0020, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch37.tar
2023-04-17 14:41:51,425 - INFO - epoch complete!
2023-04-17 14:41:51,425 - INFO - evaluating now!
2023-04-17 14:41:51,442 - INFO - Epoch [38/50] train_loss: 4.0020, val_loss: 3.9983, lr: 0.000100, 0.05s
2023-04-17 14:41:51,448 - INFO - Saved model at 38
2023-04-17 14:41:51,448 - INFO - Val loss decrease from 4.0020 to 3.9983, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch38.tar
2023-04-17 14:41:51,484 - INFO - epoch complete!
2023-04-17 14:41:51,484 - INFO - evaluating now!
2023-04-17 14:41:51,502 - INFO - Epoch [39/50] train_loss: 3.9983, val_loss: 3.9946, lr: 0.000010, 0.05s
2023-04-17 14:41:51,507 - INFO - Saved model at 39
2023-04-17 14:41:51,507 - INFO - Val loss decrease from 3.9983 to 3.9946, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch39.tar
2023-04-17 14:41:51,541 - INFO - epoch complete!
2023-04-17 14:41:51,541 - INFO - evaluating now!
2023-04-17 14:41:51,559 - INFO - Epoch [40/50] train_loss: 3.9946, val_loss: 3.9942, lr: 0.000010, 0.05s
2023-04-17 14:41:51,565 - INFO - Saved model at 40
2023-04-17 14:41:51,565 - INFO - Val loss decrease from 3.9946 to 3.9942, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch40.tar
2023-04-17 14:41:51,603 - INFO - epoch complete!
2023-04-17 14:41:51,604 - INFO - evaluating now!
2023-04-17 14:41:51,630 - INFO - Epoch [41/50] train_loss: 3.9942, val_loss: 3.9938, lr: 0.000010, 0.06s
2023-04-17 14:41:51,641 - INFO - Saved model at 41
2023-04-17 14:41:51,641 - INFO - Val loss decrease from 3.9942 to 3.9938, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch41.tar
2023-04-17 14:41:51,680 - INFO - epoch complete!
2023-04-17 14:41:51,680 - INFO - evaluating now!
2023-04-17 14:41:51,697 - INFO - Epoch [42/50] train_loss: 3.9938, val_loss: 3.9934, lr: 0.000010, 0.06s
2023-04-17 14:41:51,703 - INFO - Saved model at 42
2023-04-17 14:41:51,703 - INFO - Val loss decrease from 3.9938 to 3.9934, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch42.tar
2023-04-17 14:41:51,739 - INFO - epoch complete!
2023-04-17 14:41:51,739 - INFO - evaluating now!
2023-04-17 14:41:51,758 - INFO - Epoch [43/50] train_loss: 3.9934, val_loss: 3.9931, lr: 0.000010, 0.06s
2023-04-17 14:41:51,764 - INFO - Saved model at 43
2023-04-17 14:41:51,764 - INFO - Val loss decrease from 3.9934 to 3.9931, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch43.tar
2023-04-17 14:41:51,799 - INFO - epoch complete!
2023-04-17 14:41:51,800 - INFO - evaluating now!
2023-04-17 14:41:51,818 - INFO - Epoch [44/50] train_loss: 3.9931, val_loss: 3.9926, lr: 0.000010, 0.05s
2023-04-17 14:41:51,824 - INFO - Saved model at 44
2023-04-17 14:41:51,824 - INFO - Val loss decrease from 3.9931 to 3.9926, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch44.tar
2023-04-17 14:41:51,867 - INFO - epoch complete!
2023-04-17 14:41:51,868 - INFO - evaluating now!
2023-04-17 14:41:51,885 - INFO - Epoch [45/50] train_loss: 3.9926, val_loss: 3.9922, lr: 0.000010, 0.06s
2023-04-17 14:41:51,891 - INFO - Saved model at 45
2023-04-17 14:41:51,891 - INFO - Val loss decrease from 3.9926 to 3.9922, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch45.tar
2023-04-17 14:41:51,927 - INFO - epoch complete!
2023-04-17 14:41:51,927 - INFO - evaluating now!
2023-04-17 14:41:51,945 - INFO - Epoch [46/50] train_loss: 3.9922, val_loss: 3.9918, lr: 0.000010, 0.05s
2023-04-17 14:41:51,950 - INFO - Saved model at 46
2023-04-17 14:41:51,950 - INFO - Val loss decrease from 3.9922 to 3.9918, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch46.tar
2023-04-17 14:41:51,990 - INFO - epoch complete!
2023-04-17 14:41:51,990 - INFO - evaluating now!
2023-04-17 14:41:52,010 - INFO - Epoch [47/50] train_loss: 3.9918, val_loss: 3.9914, lr: 0.000010, 0.06s
2023-04-17 14:41:52,015 - INFO - Saved model at 47
2023-04-17 14:41:52,015 - INFO - Val loss decrease from 3.9918 to 3.9914, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch47.tar
2023-04-17 14:41:52,050 - INFO - epoch complete!
2023-04-17 14:41:52,050 - INFO - evaluating now!
2023-04-17 14:41:52,069 - INFO - Epoch [48/50] train_loss: 3.9914, val_loss: 3.9910, lr: 0.000010, 0.05s
2023-04-17 14:41:52,074 - INFO - Saved model at 48
2023-04-17 14:41:52,075 - INFO - Val loss decrease from 3.9914 to 3.9910, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch48.tar
2023-04-17 14:41:52,109 - INFO - epoch complete!
2023-04-17 14:41:52,109 - INFO - evaluating now!
2023-04-17 14:41:52,126 - INFO - Epoch [49/50] train_loss: 3.9910, val_loss: 3.9906, lr: 0.000010, 0.05s
2023-04-17 14:41:52,131 - INFO - Saved model at 49
2023-04-17 14:41:52,131 - INFO - Val loss decrease from 3.9910 to 3.9906, saving to ./libcity/cache/50001/model_cache/RNN_Xiongan_grid_epoch49.tar
2023-04-17 14:41:52,131 - INFO - Trained totally 50 epochs, average train time is 0.035s, average eval time is 0.018s
2023-04-17 14:41:52,138 - INFO - Loaded model at 49
2023-04-17 14:41:52,138 - INFO - Saved model at ./libcity/cache/50001/model_cache/GRU_Xiongan_grid.m
2023-04-17 14:41:52,143 - INFO - Start evaluating ...
2023-04-17 14:41:52,261 - INFO - Note that you select the single mode to evaluate!
2023-04-17 14:41:52,271 - INFO - Evaluate result is saved at ./libcity/cache/50001/evaluate_cache/2023_04_17_14_41_52_RNN_Xiongan_grid.csv
2023-04-17 14:41:52,286 - INFO - 
         MAE      MAPE        MSE      RMSE  masked_MAE  masked_MAPE  masked_MSE  masked_RMSE        R2      EVAR
1   2.423267  0.040939  13.491141  3.673029    2.423267     0.040939   13.491141     3.673029  0.601669  0.601723
2   3.342379  0.056106  20.562687  4.534610    3.342379     0.056106   20.562687     4.534610  0.322891  0.323022
3   3.850474  0.064887  25.007317  5.000731    3.850474     0.064887   25.007317     5.000731  0.200138  0.200302
4   4.010019  0.068081  25.726538  5.072134    4.010019     0.068081   25.726538     5.072134  0.208919  0.208995
5   4.398345  0.073693  29.781996  5.457288    4.398345     0.073693   29.781996     5.457288  0.115215  0.118524
6   4.480515  0.076186  31.257072  5.590803    4.480515     0.076186   31.257072     5.590803  0.092058  0.092183
7   4.459311  0.075778  30.674423  5.538450    4.459311     0.075778   30.674423     5.538450  0.064783  0.066646
8   4.236914  0.071671  27.303394  5.225265    4.236914     0.071671   27.303394     5.225265  0.120075  0.120599
9   4.470121  0.075058  30.706129  5.541311    4.470121     0.075058   30.706129     5.541311  0.068434  0.070125
10  4.283735  0.072444  28.987036  5.383961    4.283735     0.072444   28.987036     5.383961  0.142619  0.143961
11  4.013798  0.068037  26.032341  5.102190    4.013798     0.068037   26.032341     5.102190  0.189132  0.189139
12  3.918233  0.067334  25.769352  5.076352    3.918233     0.067334   25.769352     5.076352  0.159071  0.163720
